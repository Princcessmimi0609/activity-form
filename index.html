<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

     <style>
        /* Blurred background layer */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            font-family: Arial, sans-serif;
            background-image: url('https://www.hdwallpapers.in/download/closeup_photo_of_white_cherry_blossoms_flowers_in_blur_background_4k_hd_nature-1920x1080.jpg');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-position: center;
            filter: blur(8px);
            z-index: -1;
        }
        body {
            margin: 35;
            height: 100vh;
            display: flex;
            justify-content: center; /* centers horizontally */
            align-items: center;     /* centers vertically */
            background-image: url('background.jpg'); /* set your background image */
            background-size: cover;
            background-position: center;
            font-family: Arial, sans-serif;
            }

            form {
            background-color: rgba(255, 255, 255, 0.9); /* optional: adds a white transparent box */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8); /* Semi-transparent white background */
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* Drop shadow */
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group textarea {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box; /* Include padding and border in width calculation */
        }

        .form-group textarea {
            height: 150px;
        }

        .form-group button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
        }

        .form-group button:hover {
            background-color: #45a049;
        }

        /*
        .success-message {
            display: none;
            text-align: center;
            font-size: 20px;
            color: #4CAF50;
        } */

        div.a {
            text-align: center;
            font-size: 16px;
            color: black;
            margin-top: 20px;
            margin-left: 60px;
        }
    </style>    

    </head>
        <div class="a">
            <img src="images/Glasgow.png" alt="Glasgow" width="200" height="200">
            <h1>The Churches of God in Glasgow</h1>
            <a href="https://www.bing.com/ck/a?!&&p=94537a9706e5d521585637f05f270b75a533a34dfa1a228ea69c57e613eebc2aJmltdHM9MTc1MDM3NzYwMA&ptn=3&ver=2&hsh=4&fclid=1d265eda-3553-622f-0b20-4b37346b63c3&u=a1L21hcHM_Jm1lcGk9MTI3fn5Vbmtub3dufkFkZHJlc3NfTGluayZ0eT0xOCZxPUNvbHN0b24lMjBNaWx0b24lMjBQYXJpc2glMjBDaHVyY2gmc3M9eXBpZC5ZTjEwMjl4MTA2NDI4Mzc4JnBwb2lzPTU1Ljg5OTM5MTE3NDMxNjQwNl8tNC4yNTM4MjE4NDk4MjI5OThfQ29sc3RvbiUyME1pbHRvbiUyMFBhcmlzaCUyMENodXJjaF9ZTjEwMjl4MTA2NDI4Mzc4fiZjcD01NS44OTkzOTF-LTQuMjUzODIyJnY9MiZzVj0xJkZPUk09TVBTUlBM&ntb=1">
                Address: 20 Egilsay Crescent, Glasgow G22 7PF </a>
        </div>

<body>
  <div class="container-lg">
    <div class="d-flex justify-content-center" id="root">
      <form id="applicationForm" class="mt-4">
        <div class="row mb-3">
            <label for="NameInput" class="form-label">Name</label>
            <input type="text" class="form-control" id="NameInput" name="name" required>
          </div>   

          <div class="row mb-3">
            <label for="AdultInput" class="form-label">Adult</label>
            <input type="number" class="form-control" id="AdultInput" name="adult" required>
          </div>

          <div class="row mb-3">
            <label for="HighSchoolInput" class="form-label">High School</label>
            <input type="number" class="form-control" id="HighSchoolInput" name="highSchool" required>
          </div>

          <div class="row mb-3">
            <label for="PrimaryInput" class="form-label">Primary School</label>
            <input type="number" class="form-control" id="PrimaryInput" name="primarySchool" required>
          </div>

          <div class="row mb-3">
            <label for="ToddlerInput" class="form-label">Toddler</label>
            <input type="number" class="form-control" id="ToddlerInput" name="toddler" required>
          </div>

        <div class="mb-3">
          <label for="EmailInput" class="form-label">Email Address</label>
          <input type="email" class="form-control" id="EmailInput" name="emailAddress">
        </div>
       
        <div class="mb-3">
          <label for="FileInput_RImage" class="form-label">Image</label>
          <input type="file" class="form-control" id="FileInput_RImage" accept=".jpg,.png,.pdf" name="image">
        </div>
       
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>
  </div>    

    <script type="text/javascript">
        async function handleFormSubmission(event){
            event.preventDefault();

            const form = document.getElementById("applicationForm");
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            const image_fileContent = await new Promise((resolve, reject) =>{
                const fileReader = new FileReader();
                fileReader.onload = (event) => resolve(event.target.result);
                fileReader.onerror = (error) => reject(error);
                fileReader.readAsDataURL(data.image);
            });            
        

        console.log(image_fileContent);


            const formattedData = {
                name : data.name,
                adult : data.adult,
                highSchool : data.highSchool,
                primarySchool : data.primarySchool,
                toddler : data.toddler,
                emailAddress : data.emailAddress,
                image : {
                    fileName : data.image.name,
                    fileType : data.image.type,
                    fileContent : image_fileContent
                }                
            };

            
            fetch("https://default362a4d9a4ee448f192595cb3b51294.18.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/ef5cf03a4f3042c9a0b3a1f393455eba/triggers/manual/paths/invoke/?api-version=1&tenantId=tId&environmentName=Default-362a4d9a-4ee4-48f1-9259-5cb3b5129418",
                {
                    method : "POST",
                    headers : {
                        "Content-Type" : "application/json"
                    },
                    body : JSON.stringify(formattedData)
                }); 


                // Show thank-you message & reset the form
                const root = document.getElementById("root");
                root.innerHTML = `
                <div class="text-center">
                <h1 style="color: blue;"><br>ðŸŽ‰Congrats !</br>Your have successfully submitted the form !</br></h1>
                <button class="btn btn-secondary mt-3" onclick="window.location.reload();">Submit again</button>
            </div>
`;
        }
                   
        window.onload = () => {
            const form = document.getElementById("applicationForm");
            form.addEventListener("submit", handleFormSubmission); 
        }    
</script>
</body>
